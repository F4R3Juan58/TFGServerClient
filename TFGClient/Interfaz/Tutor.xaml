<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TFGClient.Interfaz.Tutor"
             Title="Tutor"
             BackgroundColor="#F5F5F5">

    <!-- Recursos compartidos Styles de EducaMadrid -->
    <ContentPage.Resources>
        <ResourceDictionary>
            <Color x:Key="PrimaryColor">#00539F</Color>
            <Color x:Key="SecondaryColor">#00AEEF</Color>
            <Color x:Key="AccentColor">#FFD200</Color>

            <Style TargetType="Frame" x:Key="CardStyle">
                <Setter Property="CornerRadius" Value="16" />
                <Setter Property="Padding" Value="20" />
                <Setter Property="Margin" Value="12" />
                <Setter Property="HasShadow" Value="True" />
                <Setter Property="BackgroundColor" Value="White" />
            </Style>
            <Style TargetType="Button" x:Key="PrimaryButton">
                <Setter Property="BackgroundColor" Value="{StaticResource PrimaryColor}" />
                <Setter Property="TextColor" Value="White" />
                <Setter Property="CornerRadius" Value="10" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="HeightRequest" Value="50" />
                <Setter Property="Margin" Value="6" />
            </Style>
            <Style TargetType="Button" x:Key="SecondaryButton">
                <Setter Property="BackgroundColor" Value="{StaticResource SecondaryColor}" />
                <Setter Property="TextColor" Value="White" />
                <Setter Property="CornerRadius" Value="10" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="HeightRequest" Value="50" />
                <Setter Property="Margin" Value="6" />
            </Style>
            <Style TargetType="Label" x:Key="SectionHeader">
                <Setter Property="FontSize" Value="20" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="TextColor" Value="{StaticResource PrimaryColor}" />
                <Setter Property="Margin" Value="0,0,0,10" />
            </Style>
            <Style TargetType="Label" x:Key="FieldLabel">
                <Setter Property="FontSize" Value="16" />
                <Setter Property="VerticalOptions" Value="Center" />
                <Setter Property="TextColor" Value="Black" />
                <Setter Property="Margin" Value="0,0,8,0" />
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="20">
            <!-- 1. Selección de alumno y canal temporal -->
            <Frame Style="{StaticResource CardStyle}">
                <VerticalStackLayout Spacing="12">
                    <Label Text="Selecciona un alumno:" Style="{StaticResource SectionHeader}" />
                    <Picker x:Name="pickerAlumno" Title="Alumnos disponibles" />
                    <Button Text="Crear canal temporal (texto + voz)"
                            Style="{StaticResource SecondaryButton}"
                            Clicked="crearCanalTemporal" />
                </VerticalStackLayout>
            </Frame>

            <!-- 2. Administrar rol de delegado -->
            <Frame Style="{StaticResource CardStyle}">
                <VerticalStackLayout Spacing="12">
                    <Label Text="Administrar rol de delegado:" Style="{StaticResource SectionHeader}" />
                    <HorizontalStackLayout Spacing="12">
                        <Button Text="Asignar delegado"
                                Style="{StaticResource PrimaryButton}"
                                Clicked="asignarDelegado" />
                        <Button Text="Revocar delegado"
                                Style="{StaticResource SecondaryButton}"
                                Clicked="revocarDelegado" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- 3. Crear votaciones -->
            <Frame Style="{StaticResource CardStyle}">
                <VerticalStackLayout Spacing="12">
                    <Label Text="Crear votaciones:" Style="{StaticResource SectionHeader}" />
                    <Button Text="Crear nueva votación"
                            Style="{StaticResource PrimaryButton}"
                            Clicked="crearVotacion" />
                </VerticalStackLayout>
            </Frame>

            <!-- 4. Crear Canal de FCT -->
            <Frame Style="{StaticResource CardStyle}">
                <Button Text="Crear Canal de FCT"
                        Style="{StaticResource PrimaryButton}" />
            </Frame>

            <!-- 5. Asignar roles FCT -->
            <Frame Style="{StaticResource CardStyle}">
                <VerticalStackLayout Spacing="12">
                    <Label Text="Asignar rol FCT por alumno:" Style="{StaticResource SectionHeader}" />
                    <CollectionView ItemsSource="{Binding Students}"
                                    SelectionMode="None"
                                    HeightRequest="200">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid ColumnDefinitions="*,Auto" Padding="8">
                                    <Label Text="{Binding Name}"
                                           Style="{StaticResource FieldLabel}"
                                           Grid.Column="0" />
                                    <CheckBox IsChecked="{Binding IsFCT}"
                                              Grid.Column="1"
                                              VerticalOptions="Center" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                    <Button Text="Guardar roles FCT"
                            Style="{StaticResource SecondaryButton}"
                            Command="{Binding SaveFCTRolesCommand}" />
                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
